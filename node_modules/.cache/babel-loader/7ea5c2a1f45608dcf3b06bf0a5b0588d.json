{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.enhanceReducer = exports.buildOfflineUpdater = exports.initialState = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _constants = require(\"./constants\");\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(source, true).forEach(function (key) {\n        (0, _defineProperty2.default)(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(source).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar initialState = {\n  busy: false,\n  lastTransaction: 0,\n  online: false,\n  outbox: [],\n  retryCount: 0,\n  retryScheduled: false,\n  netInfo: {\n    isConnectionExpensive: null,\n    reach: 'NONE'\n  }\n};\nexports.initialState = initialState;\n\nvar buildOfflineUpdater = function buildOfflineUpdater(dequeue, enqueue) {\n  return function offlineUpdater() {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n    var action = arguments.length > 1 ? arguments[1] : undefined; // Update online/offline status\n\n    if (action.type === _constants.OFFLINE_STATUS_CHANGED && !action.meta) {\n      return _objectSpread({}, state, {\n        online: action.payload.online,\n        netInfo: action.payload.netInfo\n      });\n    }\n\n    if (action.type === _constants.PERSIST_REHYDRATE && action.payload) {\n      return _objectSpread({}, state, {}, action.payload.offline || {}, {\n        online: state.online,\n        netInfo: state.netInfo,\n        retryScheduled: initialState.retryScheduled,\n        retryCount: initialState.retryCount,\n        busy: initialState.busy\n      });\n    }\n\n    if (action.type === _constants.OFFLINE_SCHEDULE_RETRY) {\n      return _objectSpread({}, state, {\n        retryScheduled: true,\n        retryCount: state.retryCount + 1\n      });\n    }\n\n    if (action.type === _constants.OFFLINE_COMPLETE_RETRY) {\n      return _objectSpread({}, state, {\n        retryScheduled: false\n      });\n    }\n\n    if (action.type === _constants.OFFLINE_BUSY && !action.meta && action.payload && typeof action.payload.busy === 'boolean') {\n      return _objectSpread({}, state, {\n        busy: action.payload.busy\n      });\n    } // Add offline actions to queue\n\n\n    if (action.meta && action.meta.offline) {\n      var transaction = state.lastTransaction + 1;\n\n      var stamped = _objectSpread({}, action, {\n        meta: _objectSpread({}, action.meta, {\n          transaction: transaction\n        })\n      });\n\n      var offline = state;\n      return _objectSpread({}, state, {\n        lastTransaction: transaction,\n        outbox: enqueue(offline.outbox, stamped, {\n          offline: offline\n        })\n      });\n    } // Remove completed actions from queue (success or fail)\n\n\n    if (action.meta && action.meta.completed === true) {\n      var _offline = state;\n      return _objectSpread({}, state, {\n        outbox: dequeue(_offline.outbox, action, {\n          offline: _offline\n        }),\n        retryCount: 0\n      });\n    }\n\n    if (action.type === _constants.RESET_STATE) {\n      return _objectSpread({}, initialState, {\n        online: state.online,\n        netInfo: state.netInfo\n      });\n    }\n\n    return state;\n  };\n};\n\nexports.buildOfflineUpdater = buildOfflineUpdater;\n\nvar enhanceReducer = function enhanceReducer(reducer, config) {\n  var _config$queue = config.queue,\n      dequeue = _config$queue.dequeue,\n      enqueue = _config$queue.enqueue;\n  var offlineUpdater = buildOfflineUpdater(dequeue, enqueue);\n  return function (state, action) {\n    var offlineState;\n    var restState;\n\n    if (typeof state !== 'undefined') {\n      offlineState = config.offlineStateLens(state).get;\n      restState = config.offlineStateLens(state).set();\n    }\n\n    return config.offlineStateLens(reducer(restState, action)).set(offlineUpdater(offlineState, action));\n  };\n};\n\nexports.enhanceReducer = enhanceReducer;","map":{"version":3,"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","enhanceReducer","buildOfflineUpdater","initialState","_defineProperty2","_constants","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","default","getOwnPropertyDescriptors","defineProperties","busy","lastTransaction","online","outbox","retryCount","retryScheduled","netInfo","isConnectionExpensive","reach","dequeue","enqueue","offlineUpdater","state","undefined","action","type","OFFLINE_STATUS_CHANGED","meta","payload","PERSIST_REHYDRATE","offline","OFFLINE_SCHEDULE_RETRY","OFFLINE_COMPLETE_RETRY","OFFLINE_BUSY","transaction","stamped","completed","_offline","RESET_STATE","reducer","config","_config$queue","queue","offlineState","restState","offlineStateLens","get","set"],"sources":["/Users/roaldmaravillas/ro/sandbox/aws-mobile-appsync-events-starter-react/node_modules/@redux-offline/redux-offline/lib/updater.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.enhanceReducer = exports.buildOfflineUpdater = exports.initialState = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _constants = require(\"./constants\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar initialState = {\n  busy: false,\n  lastTransaction: 0,\n  online: false,\n  outbox: [],\n  retryCount: 0,\n  retryScheduled: false,\n  netInfo: {\n    isConnectionExpensive: null,\n    reach: 'NONE'\n  }\n};\nexports.initialState = initialState;\n\nvar buildOfflineUpdater = function buildOfflineUpdater(dequeue, enqueue) {\n  return function offlineUpdater() {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n\n    // Update online/offline status\n    if (action.type === _constants.OFFLINE_STATUS_CHANGED && !action.meta) {\n      return _objectSpread({}, state, {\n        online: action.payload.online,\n        netInfo: action.payload.netInfo\n      });\n    }\n\n    if (action.type === _constants.PERSIST_REHYDRATE && action.payload) {\n      return _objectSpread({}, state, {}, action.payload.offline || {}, {\n        online: state.online,\n        netInfo: state.netInfo,\n        retryScheduled: initialState.retryScheduled,\n        retryCount: initialState.retryCount,\n        busy: initialState.busy\n      });\n    }\n\n    if (action.type === _constants.OFFLINE_SCHEDULE_RETRY) {\n      return _objectSpread({}, state, {\n        retryScheduled: true,\n        retryCount: state.retryCount + 1\n      });\n    }\n\n    if (action.type === _constants.OFFLINE_COMPLETE_RETRY) {\n      return _objectSpread({}, state, {\n        retryScheduled: false\n      });\n    }\n\n    if (action.type === _constants.OFFLINE_BUSY && !action.meta && action.payload && typeof action.payload.busy === 'boolean') {\n      return _objectSpread({}, state, {\n        busy: action.payload.busy\n      });\n    } // Add offline actions to queue\n\n\n    if (action.meta && action.meta.offline) {\n      var transaction = state.lastTransaction + 1;\n\n      var stamped = _objectSpread({}, action, {\n        meta: _objectSpread({}, action.meta, {\n          transaction: transaction\n        })\n      });\n\n      var offline = state;\n      return _objectSpread({}, state, {\n        lastTransaction: transaction,\n        outbox: enqueue(offline.outbox, stamped, {\n          offline: offline\n        })\n      });\n    } // Remove completed actions from queue (success or fail)\n\n\n    if (action.meta && action.meta.completed === true) {\n      var _offline = state;\n      return _objectSpread({}, state, {\n        outbox: dequeue(_offline.outbox, action, {\n          offline: _offline\n        }),\n        retryCount: 0\n      });\n    }\n\n    if (action.type === _constants.RESET_STATE) {\n      return _objectSpread({}, initialState, {\n        online: state.online,\n        netInfo: state.netInfo\n      });\n    }\n\n    return state;\n  };\n};\n\nexports.buildOfflineUpdater = buildOfflineUpdater;\n\nvar enhanceReducer = function enhanceReducer(reducer, config) {\n  var _config$queue = config.queue,\n      dequeue = _config$queue.dequeue,\n      enqueue = _config$queue.enqueue;\n  var offlineUpdater = buildOfflineUpdater(dequeue, enqueue);\n  return function (state, action) {\n    var offlineState;\n    var restState;\n\n    if (typeof state !== 'undefined') {\n      offlineState = config.offlineStateLens(state).get;\n      restState = config.offlineStateLens(state).set();\n    }\n\n    return config.offlineStateLens(reducer(restState, action)).set(offlineUpdater(offlineState, action));\n  };\n};\n\nexports.enhanceReducer = enhanceReducer;"],"mappings":"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"},"metadata":{},"sourceType":"script"}