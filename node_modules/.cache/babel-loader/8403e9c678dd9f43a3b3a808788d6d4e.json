{"ast":null,"code":"\"use strict\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar subscription_handshake_link_1 = require(\"./subscription-handshake-link\");\n\nexports.CONTROL_EVENTS_KEY = subscription_handshake_link_1.CONTROL_EVENTS_KEY;\n\nvar apollo_link_1 = require(\"apollo-link\");\n\nvar apollo_link_http_1 = require(\"apollo-link-http\");\n\nvar apollo_utilities_1 = require(\"apollo-utilities\");\n\nvar non_terminating_link_1 = require(\"./non-terminating-link\");\n\nvar realtime_subscription_handshake_link_1 = require(\"./realtime-subscription-handshake-link\");\n\nfunction createSubscriptionHandshakeLink(infoOrUrl, theResultsFetcherLink) {\n  var resultsFetcherLink, subscriptionLinks;\n\n  if (typeof infoOrUrl === \"string\") {\n    resultsFetcherLink = theResultsFetcherLink || apollo_link_http_1.createHttpLink({\n      uri: infoOrUrl\n    });\n    subscriptionLinks = apollo_link_1.ApolloLink.from([new non_terminating_link_1.NonTerminatingLink(\"controlMessages\", {\n      link: new apollo_link_1.ApolloLink(function (operation, _forward) {\n        return new apollo_link_1.Observable(function (observer) {\n          var _a;\n\n          var _b = operation,\n              _c = _b.variables,\n              _d = subscription_handshake_link_1.CONTROL_EVENTS_KEY,\n              controlEvents = _c[_d],\n              variables = __rest(_c, [typeof _d === \"symbol\" ? _d : _d + \"\"]);\n\n          if (typeof controlEvents !== \"undefined\") {\n            operation.variables = variables;\n          }\n\n          observer.next((_a = {}, _a[subscription_handshake_link_1.CONTROL_EVENTS_KEY] = controlEvents, _a));\n          return function () {};\n        });\n      })\n    }), new non_terminating_link_1.NonTerminatingLink(\"subsInfo\", {\n      link: resultsFetcherLink\n    }), new subscription_handshake_link_1.SubscriptionHandshakeLink(\"subsInfo\")]);\n  } else {\n    var url = infoOrUrl.url;\n    resultsFetcherLink = theResultsFetcherLink || apollo_link_http_1.createHttpLink({\n      uri: url\n    });\n    subscriptionLinks = new realtime_subscription_handshake_link_1.AppSyncRealTimeSubscriptionHandshakeLink(infoOrUrl);\n  }\n\n  return apollo_link_1.ApolloLink.split(function (operation) {\n    var query = operation.query;\n\n    var _a = apollo_utilities_1.getMainDefinition(query),\n        kind = _a.kind,\n        graphqlOperation = _a.operation;\n\n    var isSubscription = kind === \"OperationDefinition\" && graphqlOperation === \"subscription\";\n    return isSubscription;\n  }, subscriptionLinks, resultsFetcherLink);\n}\n\nexports.createSubscriptionHandshakeLink = createSubscriptionHandshakeLink;","map":{"version":3,"names":["__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","defineProperty","exports","value","subscription_handshake_link_1","require","CONTROL_EVENTS_KEY","apollo_link_1","apollo_link_http_1","apollo_utilities_1","non_terminating_link_1","realtime_subscription_handshake_link_1","createSubscriptionHandshakeLink","infoOrUrl","theResultsFetcherLink","resultsFetcherLink","subscriptionLinks","createHttpLink","uri","ApolloLink","from","NonTerminatingLink","link","operation","_forward","Observable","observer","_a","_b","_c","variables","_d","controlEvents","next","SubscriptionHandshakeLink","url","AppSyncRealTimeSubscriptionHandshakeLink","split","query","getMainDefinition","kind","graphqlOperation","isSubscription"],"sources":["/Users/roaldmaravillas/ro/github/scaffold-appsync-events/node_modules/aws-appsync-subscription-link/lib/index.js"],"sourcesContent":["\"use strict\";\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscription_handshake_link_1 = require(\"./subscription-handshake-link\");\nexports.CONTROL_EVENTS_KEY = subscription_handshake_link_1.CONTROL_EVENTS_KEY;\nvar apollo_link_1 = require(\"apollo-link\");\nvar apollo_link_http_1 = require(\"apollo-link-http\");\nvar apollo_utilities_1 = require(\"apollo-utilities\");\nvar non_terminating_link_1 = require(\"./non-terminating-link\");\nvar realtime_subscription_handshake_link_1 = require(\"./realtime-subscription-handshake-link\");\nfunction createSubscriptionHandshakeLink(infoOrUrl, theResultsFetcherLink) {\n    var resultsFetcherLink, subscriptionLinks;\n    if (typeof infoOrUrl === \"string\") {\n        resultsFetcherLink =\n            theResultsFetcherLink || apollo_link_http_1.createHttpLink({ uri: infoOrUrl });\n        subscriptionLinks = apollo_link_1.ApolloLink.from([\n            new non_terminating_link_1.NonTerminatingLink(\"controlMessages\", {\n                link: new apollo_link_1.ApolloLink(function (operation, _forward) {\n                    return new apollo_link_1.Observable(function (observer) {\n                        var _a;\n                        var _b = operation, _c = _b.variables, _d = subscription_handshake_link_1.CONTROL_EVENTS_KEY, controlEvents = _c[_d], variables = __rest(_c, [typeof _d === \"symbol\" ? _d : _d + \"\"]);\n                        if (typeof controlEvents !== \"undefined\") {\n                            operation.variables = variables;\n                        }\n                        observer.next((_a = {}, _a[subscription_handshake_link_1.CONTROL_EVENTS_KEY] = controlEvents, _a));\n                        return function () { };\n                    });\n                })\n            }),\n            new non_terminating_link_1.NonTerminatingLink(\"subsInfo\", { link: resultsFetcherLink }),\n            new subscription_handshake_link_1.SubscriptionHandshakeLink(\"subsInfo\")\n        ]);\n    }\n    else {\n        var url = infoOrUrl.url;\n        resultsFetcherLink = theResultsFetcherLink || apollo_link_http_1.createHttpLink({ uri: url });\n        subscriptionLinks = new realtime_subscription_handshake_link_1.AppSyncRealTimeSubscriptionHandshakeLink(infoOrUrl);\n    }\n    return apollo_link_1.ApolloLink.split(function (operation) {\n        var query = operation.query;\n        var _a = apollo_utilities_1.getMainDefinition(query), kind = _a.kind, graphqlOperation = _a.operation;\n        var isSubscription = kind === \"OperationDefinition\" && graphqlOperation === \"subscription\";\n        return isSubscription;\n    }, subscriptionLinks, resultsFetcherLink);\n}\nexports.createSubscriptionHandshakeLink = createSubscriptionHandshakeLink;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}