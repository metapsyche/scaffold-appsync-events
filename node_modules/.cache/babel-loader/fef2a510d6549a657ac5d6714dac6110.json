{"ast":null,"code":"\"use strict\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*!\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\n\nvar apollo_link_1 = require(\"apollo-link\");\n\nvar apollo_link_retry_1 = require(\"apollo-link-retry\");\n\nvar apollo_utilities_1 = require(\"apollo-utilities\");\n\nexports.PERMANENT_ERROR_KEY = typeof Symbol !== 'undefined' ? Symbol('permanentError') : '@@permanentError';\nvar BASE_TIME_MS = 100;\nvar JITTER_FACTOR = 100;\nvar MAX_DELAY_MS = 5 * 60 * 1000;\n\nvar getDelay = function (count) {\n  return Math.pow(2, count) * BASE_TIME_MS + JITTER_FACTOR * Math.random();\n};\n\nexports.SKIP_RETRY_KEY = '@@skipRetry';\n\nexports.getEffectDelay = function (_action, retries) {\n  var delay = getDelay(retries);\n  return delay <= MAX_DELAY_MS ? delay : null;\n};\n\nexports.createRetryLink = function (origLink) {\n  var delay;\n  var retryLink = new apollo_link_retry_1.RetryLink({\n    attempts: function (count, operation, error) {\n      var _a = exports.PERMANENT_ERROR_KEY,\n          _b = error[_a],\n          permanent = _b === void 0 ? false : _b;\n      var _c = exports.SKIP_RETRY_KEY,\n          _d = operation.variables[_c],\n          skipRetry = _d === void 0 ? false : _d;\n\n      if (permanent) {\n        return false;\n      }\n\n      if (error.statusCode >= 400 && error.statusCode < 500) {\n        return false;\n      }\n\n      if (apollo_utilities_1.graphQLResultHasError({\n        errors: error ? error.graphQLErrors : []\n      })) {\n        return false;\n      }\n\n      if (skipRetry) {\n        return false;\n      }\n\n      delay = getDelay(count);\n      return delay <= MAX_DELAY_MS;\n    },\n    delay: function (_count, _operation, _error) {\n      return delay;\n    }\n  });\n  var link = apollo_link_1.ApolloLink.from([retryLink, origLink]);\n  return new apollo_link_1.ApolloLink(function (operation, forward) {\n    var _a = operation.variables,\n        _b = exports.SKIP_RETRY_KEY,\n        _c = _a[_b],\n        skipRetry = _c === void 0 ? false : _c,\n        otherVars = __rest(_a, [typeof _b === \"symbol\" ? _b : _b + \"\"]);\n\n    if (skipRetry) {\n      operation.variables = otherVars;\n    }\n\n    return link.request(operation, forward);\n  });\n};","map":{"version":3,"names":["__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","defineProperty","exports","value","apollo_link_1","require","apollo_link_retry_1","apollo_utilities_1","PERMANENT_ERROR_KEY","Symbol","BASE_TIME_MS","JITTER_FACTOR","MAX_DELAY_MS","getDelay","count","Math","pow","random","SKIP_RETRY_KEY","getEffectDelay","_action","retries","delay","createRetryLink","origLink","retryLink","RetryLink","attempts","operation","error","_a","_b","permanent","_c","_d","variables","skipRetry","statusCode","graphQLResultHasError","errors","graphQLErrors","_count","_operation","_error","link","ApolloLink","from","forward","otherVars","request"],"sources":["/Users/roaldmaravillas/ro/sandbox/aws-mobile-appsync-events-starter-react/node_modules/aws-appsync/lib/link/retry-link.js"],"sourcesContent":["\"use strict\";\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/*!\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar apollo_link_1 = require(\"apollo-link\");\nvar apollo_link_retry_1 = require(\"apollo-link-retry\");\nvar apollo_utilities_1 = require(\"apollo-utilities\");\nexports.PERMANENT_ERROR_KEY = typeof Symbol !== 'undefined' ? Symbol('permanentError') : '@@permanentError';\nvar BASE_TIME_MS = 100;\nvar JITTER_FACTOR = 100;\nvar MAX_DELAY_MS = 5 * 60 * 1000;\nvar getDelay = function (count) { return ((Math.pow(2, count)) * BASE_TIME_MS) + (JITTER_FACTOR * Math.random()); };\nexports.SKIP_RETRY_KEY = '@@skipRetry';\nexports.getEffectDelay = function (_action, retries) {\n    var delay = getDelay(retries);\n    return delay <= MAX_DELAY_MS ? delay : null;\n};\nexports.createRetryLink = function (origLink) {\n    var delay;\n    var retryLink = new apollo_link_retry_1.RetryLink({\n        attempts: function (count, operation, error) {\n            var _a = exports.PERMANENT_ERROR_KEY, _b = error[_a], permanent = _b === void 0 ? false : _b;\n            var _c = exports.SKIP_RETRY_KEY, _d = operation.variables[_c], skipRetry = _d === void 0 ? false : _d;\n            if (permanent) {\n                return false;\n            }\n            if (error.statusCode >= 400 && error.statusCode < 500) {\n                return false;\n            }\n            if (apollo_utilities_1.graphQLResultHasError({ errors: error ? error.graphQLErrors : [] })) {\n                return false;\n            }\n            if (skipRetry) {\n                return false;\n            }\n            delay = getDelay(count);\n            return delay <= MAX_DELAY_MS;\n        },\n        delay: function (_count, _operation, _error) { return delay; },\n    });\n    var link = apollo_link_1.ApolloLink.from([\n        retryLink,\n        origLink,\n    ]);\n    return new apollo_link_1.ApolloLink(function (operation, forward) {\n        var _a = operation.variables, _b = exports.SKIP_RETRY_KEY, _c = _a[_b], skipRetry = _c === void 0 ? false : _c, otherVars = __rest(_a, [typeof _b === \"symbol\" ? _b : _b + \"\"]);\n        if (skipRetry) {\n            operation.variables = otherVars;\n        }\n        return link.request(operation, forward);\n    });\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}