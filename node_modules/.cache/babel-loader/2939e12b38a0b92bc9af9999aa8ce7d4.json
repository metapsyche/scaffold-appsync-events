{"ast":null,"code":"var _jsxFileName = \"/Users/roaldmaravillas/ro/github/scaffold-appsync-events/src/Components/EventComments.js\";\nimport React, { Component } from \"react\";\nimport { graphql } from \"react-apollo\";\nimport moment from 'moment';\nimport QueryGetEvent from \"../GraphQL/QueryGetEvent\";\nimport SubsriptionEventComments from \"../GraphQL/SubsriptionEventComments\";\nimport NewComment from \"./NewComment\";\n\nclass EventComments extends Component {\n  constructor() {\n    super(...arguments);\n\n    this.renderComment = comment => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"comment\",\n        key: comment.commentId,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 25,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"avatar\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 26,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"icon user circular\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 26,\n          columnNumber: 41\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 27,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 28,\n          columnNumber: 21\n        }\n      }, comment.content), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"metadata\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 31,\n          columnNumber: 21\n        }\n      }, moment(comment.createdAt).format('LL, LT'))));\n    };\n  }\n\n  componentDidMount() {\n    this.subscription = this.props.subscribeToComments();\n  }\n\n  componentWillUnmount() {\n    this.subscription();\n  }\n\n  render() {\n    const {\n      comments: {\n        items\n      },\n      eventId\n    } = this.props;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ui items\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ui comments\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"ui dividing header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 25\n      }\n    }, \"Comments\"), [].concat(items).sort((a, b) => a.createdAt.localeCompare(b.createdAt)).map(this.renderComment), /*#__PURE__*/React.createElement(NewComment, {\n      eventId: eventId,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 25\n      }\n    }))));\n  }\n\n}\n\nconst EventCommentsWithData = graphql(QueryGetEvent, {\n  options: _ref => {\n    let {\n      eventId: id\n    } = _ref;\n    return {\n      fetchPolicy: 'cache-first',\n      variables: {\n        id\n      }\n    };\n  },\n  props: props => ({\n    comments: props.data.getEvent ? props.data.getEvent.comments : {\n      items: []\n    },\n    subscribeToComments: () => props.data.subscribeToMore({\n      document: SubsriptionEventComments,\n      variables: {\n        eventId: props.ownProps.eventId\n      },\n      updateQuery: (prev, _ref2) => {\n        let {\n          subscriptionData: {\n            data: {\n              subscribeToEventComments\n            }\n          }\n        } = _ref2;\n        const res = { ...prev,\n          getEvent: { ...prev.getEvent,\n            comments: {\n              __typename: 'CommentConnections',\n              ...prev.getEvent.comments,\n              items: [...prev.getEvent.comments.items.filter(c => c.commentId !== subscribeToEventComments.commentId), subscribeToEventComments]\n            }\n          }\n        };\n        return res;\n      }\n    })\n  })\n})(EventComments);\nexport default EventCommentsWithData;","map":{"version":3,"names":["React","Component","graphql","moment","QueryGetEvent","SubsriptionEventComments","NewComment","EventComments","renderComment","comment","commentId","content","createdAt","format","componentDidMount","subscription","props","subscribeToComments","componentWillUnmount","render","comments","items","eventId","concat","sort","a","b","localeCompare","map","EventCommentsWithData","options","id","fetchPolicy","variables","data","getEvent","subscribeToMore","document","ownProps","updateQuery","prev","subscriptionData","subscribeToEventComments","res","__typename","filter","c"],"sources":["/Users/roaldmaravillas/ro/github/scaffold-appsync-events/src/Components/EventComments.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport { graphql } from \"react-apollo\";\n\nimport moment from 'moment';\n\nimport QueryGetEvent from \"../GraphQL/QueryGetEvent\";\nimport SubsriptionEventComments from \"../GraphQL/SubsriptionEventComments\";\n\nimport NewComment from \"./NewComment\";\n\nclass EventComments extends Component {\n\n    subscription;\n\n    componentDidMount() {\n        this.subscription = this.props.subscribeToComments();\n    }\n\n    componentWillUnmount() {\n        this.subscription();\n    }\n\n    renderComment = (comment) => {\n        return (\n            <div className=\"comment\" key={comment.commentId}>\n                <div className=\"avatar\"><i className=\"icon user circular\"></i></div>\n                <div className=\"content\">\n                    <div className=\"text\">\n                        {comment.content}\n                    </div>\n                    <div className=\"metadata\">{moment(comment.createdAt).format('LL, LT')}</div>\n                </div>\n            </div>\n        );\n    }\n\n    render() {\n        const { comments: { items }, eventId } = this.props;\n\n        return (\n            <div className=\"ui items\">\n                <div className=\"item\">\n                    <div className=\"ui comments\">\n                        <h4 className=\"ui dividing header\">Comments</h4>\n                        {[].concat(items).sort((a, b) => a.createdAt.localeCompare(b.createdAt)).map(this.renderComment)}\n                        <NewComment eventId={eventId} />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n}\n\nconst EventCommentsWithData = graphql(\n    QueryGetEvent,\n    {\n        options: ({ eventId: id }) => ({\n            fetchPolicy: 'cache-first',\n            variables: { id }\n        }),\n        props: props => ({\n            comments: props.data.getEvent ? props.data.getEvent.comments : { items: [] },\n            subscribeToComments: () => props.data.subscribeToMore({\n                document: SubsriptionEventComments,\n                variables: {\n                    eventId: props.ownProps.eventId,\n                },\n                updateQuery: (prev, { subscriptionData: { data: { subscribeToEventComments } } }) => {\n                    const res = {\n                        ...prev,\n                        getEvent: {\n                            ...prev.getEvent,\n                            comments: {\n                                __typename: 'CommentConnections',\n                                ...prev.getEvent.comments,\n                                items: [\n                                    ...prev.getEvent.comments.items.filter(c => c.commentId !== subscribeToEventComments.commentId),\n                                    subscribeToEventComments,\n                                ]\n                            }\n                        }\n                    };\n\n                    return res;\n                }\n            })\n        }),\n    },\n)(EventComments);\n\nexport default EventCommentsWithData;"],"mappings":"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"},"metadata":{},"sourceType":"module"}