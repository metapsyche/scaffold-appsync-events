{"ast":null,"code":"import { wrap } from './optimism';\nvar hasOwn = Object.prototype.hasOwnProperty;\n\nvar DepTrackingCache = function () {\n  function DepTrackingCache(data) {\n    if (data === void 0) {\n      data = Object.create(null);\n    }\n\n    var _this = this;\n\n    this.data = data;\n    this.depend = wrap(function (dataId) {\n      return _this.data[dataId];\n    }, {\n      disposable: true,\n      makeCacheKey: function (dataId) {\n        return dataId;\n      }\n    });\n  }\n\n  DepTrackingCache.prototype.toObject = function () {\n    return this.data;\n  };\n\n  DepTrackingCache.prototype.get = function (dataId) {\n    this.depend(dataId);\n    return this.data[dataId];\n  };\n\n  DepTrackingCache.prototype.set = function (dataId, value) {\n    var oldValue = this.data[dataId];\n\n    if (value !== oldValue) {\n      this.data[dataId] = value;\n      this.depend.dirty(dataId);\n    }\n  };\n\n  DepTrackingCache.prototype.delete = function (dataId) {\n    if (hasOwn.call(this.data, dataId)) {\n      delete this.data[dataId];\n      this.depend.dirty(dataId);\n    }\n  };\n\n  DepTrackingCache.prototype.clear = function () {\n    this.replace(null);\n  };\n\n  DepTrackingCache.prototype.replace = function (newData) {\n    var _this = this;\n\n    if (newData) {\n      Object.keys(newData).forEach(function (dataId) {\n        _this.set(dataId, newData[dataId]);\n      });\n      Object.keys(this.data).forEach(function (dataId) {\n        if (!hasOwn.call(newData, dataId)) {\n          _this.delete(dataId);\n        }\n      });\n    } else {\n      Object.keys(this.data).forEach(function (dataId) {\n        _this.delete(dataId);\n      });\n    }\n  };\n\n  return DepTrackingCache;\n}();\n\nexport { DepTrackingCache };\nexport function defaultNormalizedCacheFactory(seed) {\n  return new DepTrackingCache(seed);\n}","map":{"version":3,"sources":["../src/depTrackingCache.ts"],"names":[],"mappings":"AACA,SAAS,IAAT,QAAgD,YAAhD;AAEA,IAAM,MAAM,GAAG,MAAM,CAAC,SAAP,CAAiB,cAAhC;;AAEA,IAAA,gBAAA,GAAA,YAAA;EAKE,SAAA,gBAAA,CAAoB,IAApB,EAAqE;IAAjD,IAAA,IAAA,KAAA,KAAA,CAAA,EAAA;MAAA,IAAA,GAA8B,MAAM,CAAC,MAAP,CAAc,IAAd,CAA9B;IAAiD;;IAArE,IAAA,KAAA,GAAA,IAAA;;IAAoB,KAAA,IAAA,GAAA,IAAA;IAClB,KAAK,MAAL,GAAc,IAAI,CAAC,UACjB,MADiB,EACH;MACX,OAAA,KAAI,CAAC,IAAL,CAAA,MAAA,CAAA;IAAiB,CAFJ,EAEM;MACtB,UAAU,EAAE,IADU;MAEtB,YAAY,EAAA,UAAC,MAAD,EAAe;QACzB,OAAO,MAAP;MACD;IAJqB,CAFN,CAAlB;EAQD;;EAEM,gBAAA,CAAA,SAAA,CAAA,QAAA,GAAP,YAAA;IACE,OAAO,KAAK,IAAZ;EACD,CAFM;;EAIA,gBAAA,CAAA,SAAA,CAAA,GAAA,GAAP,UAAW,MAAX,EAAyB;IACvB,KAAK,MAAL,CAAY,MAAZ;IACA,OAAO,KAAK,IAAL,CAAU,MAAV,CAAP;EACD,CAHM;;EAKA,gBAAA,CAAA,SAAA,CAAA,GAAA,GAAP,UAAW,MAAX,EAA2B,KAA3B,EAA6C;IAC3C,IAAM,QAAQ,GAAG,KAAK,IAAL,CAAU,MAAV,CAAjB;;IACA,IAAI,KAAK,KAAK,QAAd,EAAwB;MACtB,KAAK,IAAL,CAAU,MAAV,IAAoB,KAApB;MACA,KAAK,MAAL,CAAY,KAAZ,CAAkB,MAAlB;IACD;EACF,CANM;;EAQA,gBAAA,CAAA,SAAA,CAAA,MAAA,GAAP,UAAc,MAAd,EAA4B;IAC1B,IAAI,MAAM,CAAC,IAAP,CAAY,KAAK,IAAjB,EAAuB,MAAvB,CAAJ,EAAoC;MAClC,OAAO,KAAK,IAAL,CAAU,MAAV,CAAP;MACA,KAAK,MAAL,CAAY,KAAZ,CAAkB,MAAlB;IACD;EACF,CALM;;EAOA,gBAAA,CAAA,SAAA,CAAA,KAAA,GAAP,YAAA;IACE,KAAK,OAAL,CAAa,IAAb;EACD,CAFM;;EAIA,gBAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,OAAf,EAA6C;IAA7C,IAAA,KAAA,GAAA,IAAA;;IACE,IAAI,OAAJ,EAAa;MACX,MAAM,CAAC,IAAP,CAAY,OAAZ,EAAqB,OAArB,CAA6B,UAAA,MAAA,EAAM;QACjC,KAAI,CAAC,GAAL,CAAS,MAAT,EAAiB,OAAO,CAAC,MAAD,CAAxB;MACD,CAFD;MAGA,MAAM,CAAC,IAAP,CAAY,KAAK,IAAjB,EAAuB,OAAvB,CAA+B,UAAA,MAAA,EAAM;QACnC,IAAI,CAAE,MAAM,CAAC,IAAP,CAAY,OAAZ,EAAqB,MAArB,CAAN,EAAoC;UAClC,KAAI,CAAC,MAAL,CAAY,MAAZ;QACD;MACF,CAJD;IAKD,CATD,MASO;MACL,MAAM,CAAC,IAAP,CAAY,KAAK,IAAjB,EAAuB,OAAvB,CAA+B,UAAA,MAAA,EAAM;QACnC,KAAI,CAAC,MAAL,CAAY,MAAZ;MACD,CAFD;IAGD;EACF,CAfM;;EAgBT,OAAA,gBAAA;AAAC,CA5DD,EAAA;;;AA8DA,OAAM,SAAU,6BAAV,CACJ,IADI,EACwB;EAE5B,OAAO,IAAI,gBAAJ,CAAqB,IAArB,CAAP;AACD","sourceRoot":"","sourcesContent":["import { wrap } from './optimism';\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar DepTrackingCache = (function () {\n    function DepTrackingCache(data) {\n        if (data === void 0) { data = Object.create(null); }\n        var _this = this;\n        this.data = data;\n        this.depend = wrap(function (dataId) { return _this.data[dataId]; }, {\n            disposable: true,\n            makeCacheKey: function (dataId) {\n                return dataId;\n            }\n        });\n    }\n    DepTrackingCache.prototype.toObject = function () {\n        return this.data;\n    };\n    DepTrackingCache.prototype.get = function (dataId) {\n        this.depend(dataId);\n        return this.data[dataId];\n    };\n    DepTrackingCache.prototype.set = function (dataId, value) {\n        var oldValue = this.data[dataId];\n        if (value !== oldValue) {\n            this.data[dataId] = value;\n            this.depend.dirty(dataId);\n        }\n    };\n    DepTrackingCache.prototype.delete = function (dataId) {\n        if (hasOwn.call(this.data, dataId)) {\n            delete this.data[dataId];\n            this.depend.dirty(dataId);\n        }\n    };\n    DepTrackingCache.prototype.clear = function () {\n        this.replace(null);\n    };\n    DepTrackingCache.prototype.replace = function (newData) {\n        var _this = this;\n        if (newData) {\n            Object.keys(newData).forEach(function (dataId) {\n                _this.set(dataId, newData[dataId]);\n            });\n            Object.keys(this.data).forEach(function (dataId) {\n                if (!hasOwn.call(newData, dataId)) {\n                    _this.delete(dataId);\n                }\n            });\n        }\n        else {\n            Object.keys(this.data).forEach(function (dataId) {\n                _this.delete(dataId);\n            });\n        }\n    };\n    return DepTrackingCache;\n}());\nexport { DepTrackingCache };\nexport function defaultNormalizedCacheFactory(seed) {\n    return new DepTrackingCache(seed);\n}\n//# sourceMappingURL=depTrackingCache.js.map"]},"metadata":{},"sourceType":"module"}